<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Cryptography Notes 密碼學任督二脈 | CX330</title><meta name="keywords" content="CTF,Crypto,資安,密碼學,筆記"><meta name="author" content="CX330"><meta name="copyright" content="CX330"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Cryptography Notes 密碼學任督二脈"><meta name="application-name" content="Cryptography Notes 密碼學任督二脈"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Cryptography Notes 密碼學任督二脈"><meta property="og:url" content="https://cx330.tw/StudyNotes/Cryptography-Notes-密碼學任督二脈/index.html"><meta property="og:site_name" content="CX330"><meta property="og:description" content="前言為甚麼會想寫這篇文因為自己在學習的時候一直覺得密碼學是個很困難的領域，所以決定自己把一些筆記給記錄下來。一來是幫助自己以後可以回來翻，其次也希望可以幫助到正在學習密碼學的人！加油啦！ 柯克霍夫原則 Kerckhoffs’s principle “A cryptosystem should rem"><meta property="og:locale" content="zh-TW"><meta property="og:image" content="https://cx330.tw/images/cryptography.jpg"><meta property="article:author" content="CX330"><meta property="article:tag" content="CX330, 陳子雋, CX330 universe, CX330 Blog, Blog, CTF, CX330 hacker, hacker, 資安, 駭客, 黑客, 程式設計, 程式設計師, 程式設計博客, 程式設計部落格, 程式設計日誌, 程式設計師日誌, 程式設計部落格日誌"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cx330.tw/images/cryptography.jpg"><meta name="description" content="前言為甚麼會想寫這篇文因為自己在學習的時候一直覺得密碼學是個很困難的領域，所以決定自己把一些筆記給記錄下來。一來是幫助自己以後可以回來翻，其次也希望可以幫助到正在學習密碼學的人！加油啦！ 柯克霍夫原則 Kerckhoffs’s principle “A cryptosystem should rem"><link rel="shortcut icon" href="/assets/favicon.ico"><link rel="canonical" href="https://cx330.tw/StudyNotes/Cryptography-Notes-%E5%AF%86%E7%A2%BC%E5%AD%B8%E4%BB%BB%E7%9D%A3%E4%BA%8C%E8%84%88/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-PM5RRNPNEB"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-PM5RRNPNEB');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"CX330","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: undefined,
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: 'https://comments.cx330.tw/',
  commentBarrageConfig:{"enable":true,"maxBarrage":1,"barrageTime":8000,"accessToken":"8e5a0f02d2d6b6604e700a856bf586e7","mailMd5":"25de757f9696b310771b584e7bf5b238"},
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color.cx330.tw/api?img=","cover_change":true},
  authorStatus: {"skills":["Hacker","CTFer","Developer","Programmer",1337]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查詢的內容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"轉為繁體","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '複製成功',
    error: '複製錯誤',
    noSupport: '瀏覽器不支援'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '剛剛',
    min: '分鐘前',
    hour: '小時前',
    day: '天前',
    month: '個月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: CX330","link":"連結: ","source":"來源: CX330","info":"著作權歸作者所有。商業轉載請聯絡作者獲得授權，非商業轉載請註明出處。","copySuccess":"複製成功，複製和轉載請標注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切換為繁體","cht_to_chs":"你已切換為簡體","day_to_night":"你已切換為深色模式","night_to_day":"你已切換為淺色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'CX330',
  title: 'Cryptography Notes 密碼學任督二脈',
  postAI: '',
  pageFillDescription: '前言, 為甚麼會想寫這篇文, 柯克霍夫原則 Kerckhoffs’s principle, 領域展開：密碼學的三大領域, 編碼 Encoding, 雜湊 Hashing, 加密 Encryption, 常見編碼 Common Encoding, ASCII Encoding, 簡介, Python Code, Base64 Encoding, 簡介, 原理, Python Code, 延伸, URL Encoding, 簡介, Python Code, 小結, 常見雜湊函式 Common Hash Functions, MD5, 簡介, 端序 Endian, Python Code, MD5 已死, SHA-256, 簡介, Python Code, 鹽 Salt, 古典密碼學 Classical Cryptography, 凱薩加密 Caesar Cipher, 簡介, Python Code, 暴力破解 Brute Force, 置換密碼 Transposition Cipher, 簡介, 維吉尼亞密碼 Vigenère Cipher, 簡介, 柵欄密碼 Rail Fence Cipher, 簡介, 對稱式加密 Symmetric Cryptography, 非對稱式加密 Asymmetric Cryptography, RSA, RSA 介紹, 小公鑰指數攻擊（Low public exponent attack）, Coppersmith’s Attack, 題目前言為甚麼會想寫這篇文因為自己在學習的時候一直覺得密碼學是個很困難的領域所以決定自己把一些筆記給記錄下來一來是幫助自己以後可以回來翻其次也希望可以幫助到正在學習密碼學的人加油啦柯克霍夫原則柯克霍夫原則是由在世紀提出的其內容主要就是說明一個好的加密系統即使其運作原理全部都是公開的只要金鑰未公開他就應該要是安全的資訊理論的創始人將其改說為以下說法也就是說永遠預設敵人知道你的整個加密系統是如何運作的包括其中的算法以及各種原理一個加密系統要在這樣的情境下還能保證其加密資料的安全性才稱得上是安全的領域展開密碼學的三大領域在密碼學中的任何知識幾乎都是圍繞著編碼雜湊加密這三個領域所以就先來分別簡單聊聊他們各自都是甚麼吧這裡推薦一篇文章講的滿深入淺出的一次搞懂密碼學中的三兄弟跟編碼編碼的目的是為了資料的傳輸或表達把原本的資料換一種方式表達而已因為他只是把資料轉換成另一種形式所以編碼後的資料仍然可以被解碼也就是說整個過程完全是可逆的所以這裡要特別注意編碼不是加密編碼不是加密編碼不是加密雜湊雜湊又名哈希對就是直接從直接翻過來雜湊的話主要是用於數據校驗以及數據完整性的驗證還有一些其他的安全應用比如數位簽章等雜湊算法會有以下的特性不可逆性雜湊的算法是不可逆的無法透過已知的雜湊值哈希值回推原始資料固定長度輸出不管輸入的數據長度為何哈希函式都會生成固定長度的哈希值比如的輸出長度就是固定個唯一性理想情況下兩個不同的輸入會產生不同的輸出避免碰撞加密加密就相對好理解啦就是用於保護數據的機密性確保只有被授權的用戶才能訪問數據其加密和解密的過程都依賴於密鑰密鑰的保密性也會直接的影響到數據的安全性就好比是一個保險箱要打開它需要一把鑰匙而那把鑰匙就是密鑰如果密鑰被盜取那麼保險箱也就毫無用處了常見編碼簡介這應該大家都很熟悉吧他的全名是反正不是很重要就是一個挺常見的編碼方式以下是一張表將字符串轉換為編碼將編碼轉換回字串示例簡介通常用於傳輸二進制數據的場合例如在電子郵件中嵌入圖像文件等它的範圍是從使用共個字符加上兩個額外字符和共個字符原理編碼這個名稱代表著它基於個可列印字元所形成的編碼由於所以每個位元為一個基本單元對應著一個可列印字元每個位元組為個位元相當於個基本單元代表每個位元組可以由個可列印字元表示下圖就是每個可列印字元所對應的索引值使用模組的函式進行編碼將編碼後的位元組轉換為字串並回傳將編碼的字串轉為位元組用的解碼回傳解碼後的字串測試延伸除了編碼以外這個家族還有許多例如用於等不同的編碼方式如果有興趣的話歡迎閱讀這篇文章簡介也稱作為是一種將中的特殊字符和非字符轉換為百分號後跟兩個十六進制數字的形式以確保這些字符在中能夠被正確解析和傳輸編碼解碼示例小結這裡面其實在打的時候最常用到的就是了所以其實只要熟悉一下的原理還有代碼在比賽的時候可以快速編碼解碼就可以啦常見雜湊函式如果想要了解一下哈希函式還有數位簽章的大致運作流程可以在往下看之前先看一下這部影片我自己認為它的內容簡單而且李永樂老師教的很清晰幾乎沒有任何數學難度就可以理解十分推薦去看簡介的全名是它能將任意長度的數據轉換為位長度的哈希值它的運算過程如下填充資料將資料的末尾添加一個為了標記填充的開始然後添加足夠位的使資料的長度以為單位對取模後的結果為這樣可以確保最終加上位長度信息後總長度是的整數倍最後將消息的原始長度以位為單位附加到消息的末尾使得填充後的消息長度為的倍數初始化緩衝區使用四個位的變量來存儲中間和最終的雜湊值它們分別初始化為處理資料將填充後的資料以位分成多個塊對於每個位的塊再分為個位的小塊用這些位的小塊和上面初始化好的四個位的變量進行四輪每輪步迭代運算每一步使用非線性函數和特定的常數以及循環左移操作來混淆和壓縮數據公式如下輸出最終哈希值最終將四個位的變量串聯起來成為一個位的哈希值以小端序表示看完文字敘述之後我們來看一下的圖解吧看完了那麼多可能有點頭昏腦脹但沒關係慢慢理解它的過程還有大致流程多看幾次可能就比較理解了接下來講點比較簡單理解的東西吧甚麼是端序在了解端序是甚麼之前我們先來講個有趣的吧一詞來源於十八世紀愛爾蘭作家喬納森斯威夫特的小說格列佛遊記小說中小人國為水煮蛋該從大的一端剝開還是小的一端剝開而爭論爭論的雙方分別被稱為大頭派和小頭派好了這真的十分不重要但還是滿有趣的進入正題吧端序又稱位元組順序又稱尾序它指的是排列位元組的順序或方式它又分為以下兩種大端序小端序那他們具體又有甚麼差別呢下面一張圖看完馬上可以理解其中的差別在哪如果這張圖還是不能理解那我們再看下一張圖如果看圖片看不太懂那就用文字來介紹一下首先要先知道甚麼是和是最低有效位是最高有效位和十進制類似通常是二進制數的最左側而位於最右側而大端序就是是從數據的作為起始位置而小端序是從最低有效位開始那大端序和小端序在應用上有甚麼差別呢大端序更加直觀應用於一些網絡協議中例如小端序更符合計算機科學中的數學計算順序因為最低有效位在前面更方便處理像是數據型態的轉換端序的部份我就大致介紹到這邊如果對端序有興趣想要更深入了解的話可以去看這篇文章要雜湊的消息創建一個雜湊對象將消息編碼後更新到雜湊對象中獲取雜湊值十六進制表示打印雜湊值已死為甚麼說已死呢在年中國的密碼學家王小雲和其研究同事發表了一篇論文詳細描述了如何在不到一個小時內找到的碰撞同時這也證明了是不安全的年的時候密碼學研究人員提出了一種更高效的碰撞攻擊方法稱為他還開發了一個名為的工具用於自動化生成碰撞想更詳細的了解其原理可以觀看以下影片簡介家族的雜湊函式是被美國聯邦資訊處理標準所認證的安全雜湊算法他們家族是由美國國家安全局所設計並由美國國家標準與技術研究院所發布的他們家族中除了以外還有等等的雜湊函式但這裡就主要講解最常見的和其實流程是差不多的大概的流程如下填充資料將資料的末尾添加一個為了標記填充的開始添加位直到資料的長度對取模後等於最後將資料的原始長度以為單位附加到末尾使得填充後的資料長度為的倍數初始化緩衝區使用八個位元的變量來存儲中間和最終的雜湊值是對自然數中前個質數的平方根的小數部分取前而來處理資料將填充後的資料以位分成多個塊對於每個位的塊再分為個位的小塊用這些位的小塊和原本初始化好的個變量進行迭代運算由於過程太過於複雜我會將其公式定義和圖解放在下面輸出最終哈希值當所有的位塊都處理完成後將個變量到連接起來大端序形成最終的位字節雜湊值這個雜湊值即為輸入數據的雜湊值將消息編碼為字節創建雜湊對象更新雜湊對象獲取雜湊值測試雜湊計算鹽古典密碼學古典密碼是指在計算機出現之前廣泛使用的密碼學技術這些密碼技術通常基於簡單的替換或置換規則而不涉及覆雜的數學運算儘管這些古典密碼在過去被廣泛使用但它們都存在易受攻擊的缺陷因此在現代密碼學中已經不再安全現代密碼學使用基於覆雜數學運算和密鑰管理的加密算法來確保更高的安全性且在現代密碼學中的觀點他們更像是編碼而不是加密以下是幾種常見的古典密碼凱薩加密簡介凱撒密碼是一種簡單的替換密碼通過將字母表中的每個字母向後或向前移動固定數量的位置來加密文本例如如果向後移動個位置則加密為加密為以此類推只對字母進行加密大寫字母對應表中的小寫字母對應非字母字符保持不變解密即加密的逆操作示例明文和密鑰加密明文暴力破解嘗試所有可能的密鑰進行破解因為凱撒密碼只有種可能的密鑰置換密碼簡介置換密碼重新排列明文中的字母而不改變字母本身例如列置換密碼將明文中的字母按列排列然後按特定規則讀取以生成密文維吉尼亞密碼簡介維吉尼亞密碼是一種多表替換密碼它使用關鍵字來改變每個字母的替換規則加密時將明文的每個字母與關鍵字中的對應字母相結合來確定替換規則柵欄密碼簡介柵欄密碼將明文中的字母沿著特定的線排列然後以不同的方式讀取以生成密文例如欄柵欄密碼將字母交替排列成三行然後以從上到下從左到右的順序讀取對稱式加密非對稱式加密介紹小公鑰指數攻擊題目',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-07 21:19:39',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="cx330" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="CX330" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加載頭像" src="/assets/me.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">CX330</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-list-ul faa-tada" style="font-size: 0.9em;"></i><span> 總覽</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分類</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 標籤</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-dice faa-tada" style="font-size: 0.9em;"></i><span> 抽一篇</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 社交中心</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友站</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-message faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=7032963191&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音樂吧</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 生活碎片</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> Chasing</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相簿</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 關於</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 我是誰</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/subscribe/"><i class="anzhiyufont anzhiyu-icon-rss faa-tada" style="font-size: 0.9em;"></i><span> 訂閱</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="隨機前往一個文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜尋</span></a></div><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://buymeacoffee.com/cx330" target="_blank"><img class="post-qr-code-img" alt="Buy Me a Coffee" src="/assets/buymeacoffee.png"/></a><div class="post-qr-code-desc">Buy Me a Coffee</div></li><li class="reward-item"><a href="https://cx330.tw" target="_blank"><img class="post-qr-code-img" alt="CX330" src="/assets/me.jpg"/></a><div class="post-qr-code-desc">CX330</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互動</div><span class="author-content-item-title"> 最新評論</span></div><div class="aside-list"><span>正在載入中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">音樂</div><span class="author-content-item-title">靈魂的碰撞💥</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>總覽</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">10</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="顯示模式切換" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="邊欄顯示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="熱評開關"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音樂開關"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切換"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原創</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/" itemprop="url">學習筆記</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/CTF/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>CTF</span></a><a class="article-meta__tags" href="/tags/Crypto/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Crypto</span></a><a class="article-meta__tags" href="/tags/%E8%B3%87%E5%AE%89/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>資安</span></a><a class="article-meta__tags" href="/tags/%E5%AF%86%E7%A2%BC%E5%AD%B8/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>密碼學</span></a><a class="article-meta__tags" href="/tags/%E7%AD%86%E8%A8%98/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>筆記</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Cryptography Notes 密碼學任督二脈</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">發表於</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-06-27T12:05:01.000Z" title="發表於 2024-06-27 20:05:01">2024-06-27</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新於</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-07-07T13:19:39.507Z" title="更新於 2024-07-07 21:19:39">2024-07-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字數"></i><span class="post-meta-label" title="文章字數">字數總計:</span><span class="word-count" title="文章字數">4.1k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="閱讀時長"></i><span class="post-meta-label" title="閱讀時長">閱讀時長:</span><span>14分鐘</span></span><span class="post-meta-separator"></span><span id="" data-flag-title="Cryptography Notes 密碼學任督二脈"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="閱讀量">閱讀量:</span><span id="twikoo_visitors" title="訪問量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP屬地爲Taiwan"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>Taiwan</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">評論數:</span><a href="/StudyNotes/Cryptography-Notes-%E5%AF%86%E7%A2%BC%E5%AD%B8%E4%BB%BB%E7%9D%A3%E4%BA%8C%E8%84%88/#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/images/cryptography.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://cx330.tw/StudyNotes/Cryptography-Notes-%E5%AF%86%E7%A2%BC%E5%AD%B8%E4%BB%BB%E7%9D%A3%E4%BA%8C%E8%84%88/"><header><a class="post-meta-categories" href="/categories/%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/" itemprop="url">學習筆記</a><a href="/tags/CTF/" tabindex="-1" itemprop="url">CTF</a><a href="/tags/Crypto/" tabindex="-1" itemprop="url">Crypto</a><a href="/tags/%E8%B3%87%E5%AE%89/" tabindex="-1" itemprop="url">資安</a><a href="/tags/%E5%AF%86%E7%A2%BC%E5%AD%B8/" tabindex="-1" itemprop="url">密碼學</a><a href="/tags/%E7%AD%86%E8%A8%98/" tabindex="-1" itemprop="url">筆記</a><h1 id="CrawlerTitle" itemprop="name headline">Cryptography Notes 密碼學任督二脈</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">CX330</span><time itemprop="dateCreated datePublished" datetime="2024-06-27T12:05:01.000Z" title="發表於 2024-06-27 20:05:01">2024-06-27</time><time itemprop="dateCreated datePublished" datetime="2024-07-07T13:19:39.507Z" title="更新於 2024-07-07 21:19:39">2024-07-07</time></header><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="為甚麼會想寫這篇文"><a href="#為甚麼會想寫這篇文" class="headerlink" title="為甚麼會想寫這篇文"></a>為甚麼會想寫這篇文</h2><p>因為自己在學習的時候一直覺得密碼學是個很困難的領域，所以決定自己把一些筆記給記錄下來。一來是幫助自己以後可以回來翻，其次也希望可以幫助到正在學習密碼學的人！加油啦！</p>
<h2 id="柯克霍夫原則-Kerckhoffs’s-principle"><a href="#柯克霍夫原則-Kerckhoffs’s-principle" class="headerlink" title="柯克霍夫原則 Kerckhoffs’s principle"></a>柯克霍夫原則 Kerckhoffs’s principle</h2><blockquote>
<p>“A cryptosystem should remain secure even if an adversary knows all the details of the system, except for the secret decryption key.” — <strong><em>Kerckhoffs’s principle</em></strong></p>
</blockquote>
<p>柯克霍夫原則是由 Auguste Kerckhoffs 在 19 世紀提出的，其內容主要就是說明一個好的加密系統即使其運作原理全部都是公開的，只要金鑰未公開，他就應該要是安全的。資訊理論的創始人 Claude Shannon 將其改說為以下說法。</p>
<blockquote>
<p>“The enemy knows the system” — <strong><em>Claude Shannon</em></strong></p>
</blockquote>
<p>也就是說，永遠預設敵人知道你的整個加密系統是如何運作的，包括其中的算法以及各種原理。一個加密系統要在這樣的情境下還能保證其加密資料的安全性才稱得上是安全的。</p>
<h2 id="領域展開：密碼學的三大領域"><a href="#領域展開：密碼學的三大領域" class="headerlink" title="領域展開：密碼學的三大領域"></a>領域展開：密碼學的三大領域</h2><p>在密碼學中的任何知識幾乎都是圍繞著<strong>編碼</strong>、<strong>雜湊</strong>、<strong>加密</strong>這三個領域，所以就先來分別簡單聊聊他們各自都是甚麼吧！（這裡推薦一篇文章，講的滿深入淺出的：<a target="_blank" rel="noopener" href="https://medium.com/starbugs/what-are-encoding-encrypt-and-hashing-4b03d40e7b0c">一次搞懂密碼學中的三兄弟 — Encode、Encrypt 跟 Hash</a>）</p>
<h3 id="編碼-Encoding"><a href="#編碼-Encoding" class="headerlink" title="編碼 Encoding"></a>編碼 Encoding</h3><p>編碼的目的是為了資料的傳輸或表達，把原本的資料<strong>換一種方式</strong>表達而已。因為他只是把資料轉換成另一種形式，所以編碼後的資料仍然可以被解碼（Decode），也就是說整個過程完全是<strong>可逆的</strong>。</p>
<p>所以這裡要特別注意。<strong>編碼不是加密！編碼不是加密！編碼不是加密！</strong></p>
<h3 id="雜湊-Hashing"><a href="#雜湊-Hashing" class="headerlink" title="雜湊 Hashing"></a>雜湊 Hashing</h3><p>雜湊，又名哈希（對就是直接從 Hash 直接翻過來）。雜湊的話主要是用於數據校驗以及數據完整性的驗證，還有一些其他的安全應用比如數位簽章等。雜湊算法會有以下的特性：</p>
<ol>
<li><strong>不可逆性</strong>：雜湊的算法是不可逆的，無法透過已知的雜湊值（哈希值 Hash values）回推原始資料。</li>
<li><strong>固定長度輸出</strong>：不管輸入的數據長度為何，哈希函式都會生成固定長度的哈希值。比如 SHA-256 的輸出長度就是固定 256 個 Bits。</li>
<li><strong>唯一性</strong>：理想情況下，兩個不同的輸入會產生不同的輸出（避免碰撞）。</li>
</ol>
<h3 id="加密-Encryption"><a href="#加密-Encryption" class="headerlink" title="加密 Encryption"></a>加密 Encryption</h3><p>加密就相對好理解啦！就是用於保護數據的機密性（Confidentiality），確保只有被授權的用戶才能訪問數據。其加密和解密的過程都<strong>依賴於密鑰</strong>（Key），密鑰的保密性也會直接的影響到數據的安全性。</p>
<p>就好比是一個保險箱，要打開它需要一把鑰匙，而那把鑰匙就是密鑰。如果密鑰被盜取，那麼保險箱也就毫無用處了。</p>
<h1 id="常見編碼-Common-Encoding"><a href="#常見編碼-Common-Encoding" class="headerlink" title="常見編碼 Common Encoding"></a>常見編碼 Common Encoding</h1><h2 id="ASCII-Encoding"><a href="#ASCII-Encoding" class="headerlink" title="ASCII Encoding"></a>ASCII Encoding</h2><h3 id="簡介"><a href="#簡介" class="headerlink" title="簡介"></a>簡介</h3><p>這應該大家都很熟悉吧！他的全名是 American Standard Code for Information Interchange，反正不是很重要，就是一個挺常見的編碼方式。以下是一張 ASCII 表：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/rJ6NTsq8A.png" alt="ASCII Table from GeeksforGeeks"></p>
<h3 id="Python-Code"><a href="#Python-Code" class="headerlink" title="Python Code"></a>Python Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 將字符串轉換為 ASCII 編碼</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ascii_encode</span>(<span class="params">input_string</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">ord</span>(char) <span class="keyword">for</span> char <span class="keyword">in</span> input_string]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 將 ASCII 編碼轉換回字串</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ascii_decode</span>(<span class="params">ascii_codes</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(code) <span class="keyword">for</span> code <span class="keyword">in</span> ascii_codes)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">input_string = <span class="string">&quot;This is ASCII encoding&quot;</span></span><br><span class="line">ascii_encoded = ascii_encode(input_string)</span><br><span class="line">ascii_decoded = ascii_decode(ascii_encoded)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Original string:&quot;</span>, input_string)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ASCII encoded:&quot;</span>, ascii_encoded)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ASCII decoded:&quot;</span>, ascii_decoded)</span><br></pre></td></tr></table></figure>

<h2 id="Base64-Encoding"><a href="#Base64-Encoding" class="headerlink" title="Base64 Encoding"></a>Base64 Encoding</h2><h3 id="簡介-1"><a href="#簡介-1" class="headerlink" title="簡介"></a>簡介</h3><p>Base64 通常用於傳輸二進制數據的場合，例如在電子郵件中嵌入圖像、文件等。它的範圍是從使用<code>A-Z</code>、<code>a-z</code>、<code>0-9</code>，共 62 個字符，加上兩個額外字符<code>+</code>和<code>/</code>，共 64 個字符。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>Base64 編碼這個名稱代表著它<strong>基於 64 個可列印字元</strong>所形成的編碼。由於 $\log_{2}64&#x3D;6$，所以每 6 個位元（Bit）為一個基本單元，對應著一個可列印字元。每 3 個位元組（Byte）為 24 個位元，相當於 4 個 Base64 基本單元，代表每 3 個位元組可以由 4 個可列印字元表示。下圖就是每個可列印字元所對應的索引值。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/r1KgQh5LR.png" alt="Base64 encoding table from GeeksforGeeks"></p>
<h3 id="Python-Code-1"><a href="#Python-Code-1" class="headerlink" title="Python Code"></a>Python Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base64_encode</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="comment"># 使用 base64 模組的 b64encode 函式進行編碼</span></span><br><span class="line">    encoded_bytes = base64.b64encode(data)</span><br><span class="line">    <span class="comment"># 將編碼後的位元組轉換為字串並回傳</span></span><br><span class="line">    <span class="keyword">return</span> encoded_bytes.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base64_decode</span>(<span class="params">encoded_data</span>):</span><br><span class="line">    <span class="comment"># 將 Base64 編碼的字串轉為位元組</span></span><br><span class="line">    encoded_bytes = encoded_data.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># 用 base64 的 b64decode 解碼</span></span><br><span class="line">    decoded_bytes = base64.b64decode(encoded_bytes)</span><br><span class="line">    <span class="comment"># 回傳解碼後的字串</span></span><br><span class="line">    <span class="keyword">return</span> decoded_bytes.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 測試</span></span><br><span class="line">data_to_encode = <span class="string">b&quot;This is Base64 encoding&quot;</span></span><br><span class="line"></span><br><span class="line">encoded_data = base64_encode(data_to_encode)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Base64 Encoded Data:&quot;</span>, encoded_data)</span><br><span class="line"></span><br><span class="line">decoded_data = base64_decode(encoded_data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Base64 Decoded Data:&quot;</span>, decoded_data)</span><br></pre></td></tr></table></figure>

<h3 id="延伸"><a href="#延伸" class="headerlink" title="延伸"></a>延伸</h3><p>除了 Base64 編碼以外，這個 Base 家族還有許多例如 Base16（Hex）、Base32、Base58（用於 Bitcoin）等不同的編碼方式。如果有興趣的話歡迎閱讀<a target="_blank" rel="noopener" href="https://blog.csdn.net/Sciurdae/article/details/133642336">這篇文章</a>。</p>
<h2 id="URL-Encoding"><a href="#URL-Encoding" class="headerlink" title="URL Encoding"></a>URL Encoding</h2><h3 id="簡介-2"><a href="#簡介-2" class="headerlink" title="簡介"></a>簡介</h3><p>URL Encoding 也稱作為 Percent-encoding，是一種將 URL 中的特殊字符和非 ASCII 字符轉換為百分號（%）後跟兩個十六進制數字的形式，以確保這些字符在 URL 中能夠被正確解析和傳輸。</p>
<h3 id="Python-Code-2"><a href="#Python-Code-2" class="headerlink" title="Python Code"></a>Python Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line"><span class="comment"># URL 編碼</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">url_encode</span>(<span class="params">input_string</span>):</span><br><span class="line">    <span class="keyword">return</span> urllib.parse.quote(input_string)</span><br><span class="line"></span><br><span class="line"><span class="comment"># URL 解碼</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">url_decode</span>(<span class="params">encoded_string</span>):</span><br><span class="line">    <span class="keyword">return</span> urllib.parse.unquote(encoded_string)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">input_string = <span class="string">&quot;This is URL encoding&quot;</span></span><br><span class="line">url_encoded = url_encode(input_string)</span><br><span class="line">url_decoded = url_decode(url_encoded)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Original string:&quot;</span>, input_string)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;URL encoded:&quot;</span>, url_encoded)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;URL decoded:&quot;</span>, url_decoded)</span><br></pre></td></tr></table></figure>

<h2 id="小結"><a href="#小結" class="headerlink" title="小結"></a>小結</h2><p>這裡面其實在打 CTF 的時候最常用到的就是 Base64 了，所以其實只要熟悉一下 Base64 的原理還有代碼，在比賽的時候可以快速編碼解碼就可以啦！</p>
<h1 id="常見雜湊函式-Common-Hash-Functions"><a href="#常見雜湊函式-Common-Hash-Functions" class="headerlink" title="常見雜湊函式 Common Hash Functions"></a>常見雜湊函式 Common Hash Functions</h1><p>如果想要了解一下哈希函式還有數位簽章的大致運作流程，可以在往下看之前先看一下這部影片。我自己認為它的內容簡單而且李永樂老師教的很清晰，幾乎沒有任何數學難度就可以理解！十分推薦去看！</p>
<div style="position: relative; width: 100%; height: 0; padding-bottom: 56.25%;">
    <iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://www.youtube.com/embed/uS1ZIAsvT5w" frameborder="0" allowfullscreen></iframe>
</div>

<h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><h3 id="簡介-3"><a href="#簡介-3" class="headerlink" title="簡介"></a>簡介</h3><p>MD5 的全名是 Message Digest Algorithm 5，它能將任意長度的數據轉換為 128 位（16 Bytes）長度的哈希值。它的運算過程如下：</p>
<ol>
<li><p><strong>填充資料</strong></p>
<ul>
<li>將資料的末尾添加一個”1”，為了標記填充的開始；然後添加足夠位的”0”，使資料的長度（以 Bit 為單位）對 512 取模後的結果為 448。這樣可以確保最終加上 64 位長度信息後，總長度是 512 的整數倍。</li>
<li>最後，將消息的原始長度（以位為單位）附加到消息的末尾，使得填充後的消息長度為 512 的倍數。</li>
</ul>
</li>
<li><p><strong>初始化 MD 緩衝區</strong></p>
<ul>
<li>MD5 使用四個 32 位的變量（A, B, C, D）來存儲中間和最終的雜湊值。它們分別初始化為：<ul>
<li>A &#x3D; 0x67452301</li>
<li>B &#x3D; 0xEFCDAB89</li>
<li>C &#x3D; 0x98BADCFE</li>
<li>D &#x3D; 0x10325476</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>處理資料</strong></p>
<ul>
<li><p>將填充後的資料以 512 位（64 Bytes）分成多個塊（Chunk）。</p>
</li>
<li><p>對於每個 512 位的塊，再分為 16 個 32 位的小塊。</p>
</li>
<li><p>用這些 32 位的小塊和上面初始化好的四個 32 位的變量（A, B, C, D），進行四輪（每輪 16 步）迭代運算。每一步使用非線性函數（F, G, H, I）和特定的常數以及循環左移操作，來混淆和壓縮數據。公式如下：</p>
<p>  $F(X, Y, Z) &#x3D; (X \land Y) \lor (\neg X \land Z)$<br>  $G(X, Y, Z) &#x3D; (X \land Z) \lor (Y \land \neg Z)$<br>  $H(X, Y, Z) &#x3D; X \oplus Y \oplus Z$<br>  $I(X, Y, Z) &#x3D; Y \oplus (X \lor \neg Z)$<br>  $\oplus, \land, \lor, \neg \text{ are the signs of XOR, AND, OR, NOT}$</p>
</li>
</ul>
</li>
<li><p><strong>輸出最終哈希值</strong></p>
<ul>
<li>最終將四個 32 位的變量 A, B, C, D 串聯起來成為一個 128 位的哈希值（以小端序表示）</li>
</ul>
</li>
</ol>
<p>看完文字敘述之後我們來看一下 MD5 的圖解吧！</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/BJav5njU0.png" alt="圖示 MD5 from Wikipedia"></p>
<p>看完了那麼多可能有點頭昏腦脹，但沒關係！慢慢理解它的過程還有大致流程，多看幾次可能就比較理解了。接下來講點比較簡單理解的東西吧！甚麼是 Endian？</p>
<h3 id="端序-Endian"><a href="#端序-Endian" class="headerlink" title="端序 Endian"></a>端序 Endian</h3><p>在了解端序是甚麼之前，我們先來講個有趣的吧！</p>
<blockquote>
<p>「endian」一詞來源於十八世紀愛爾蘭作家喬納森·斯威夫特（Jonathan Swift）的小說《格列佛遊記》（Gulliver’s Travels）。小說中，小人國為水煮蛋該從大的一端（Big-End）剝開還是小的一端（Little-End）剝開而爭論，爭論的雙方分別被稱為「大頭派（Big-Endians）」和「小頭派（Little-Endians）」。（From <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-tw/%E5%AD%97%E8%8A%82%E5%BA%8F">Wikipedia</a>）</p>
</blockquote>
<p>好了這真的十分不重要但還是滿有趣的 XD。進入正題吧！</p>
<p>端序，又稱位元組順序，又稱尾序。它指的是排列位元組的順序或方式。它又分為以下兩種：</p>
<ol>
<li><strong>大端序 Big-Endian</strong></li>
<li><strong>小端序 little-Endian</strong></li>
</ol>
<p>那他們具體又有甚麼差別呢？下面一張圖看完馬上可以理解其中的差別在哪！</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/ryh8Rhj8C.png" alt="Source: The Bit Theories"></p>
<p>如果這張圖還是不能理解，那我們再看下一張圖！</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/rJO9p3iI0.png" alt="Little Endian, things are stored in reverse order. Source: fundd.blogspot.in"></p>
<p>如果看圖片看不太懂，那就用文字來介紹一下。</p>
<p>首先，要先知道甚麼是 LSB 和 MSB，LSB 是最低有效位（Least Significant Bit，LSB）；MSB 是最高有效位（Most Significant Bit，MSB）。和十進制類似，通常 MSB 是二進制數的最左側，而 LSB 位於最右側。</p>
<p>而大端序就是是從數據的 MSB 作為起始位置；而小端序是從最低有效位 LSB 開始。</p>
<p>那大端序和小端序在應用上有甚麼差別呢？</p>
<ol>
<li><strong>大端序</strong><ul>
<li>更加直觀</li>
<li>應用於一些網絡協議中，例如 TCP&#x2F;IP</li>
</ul>
</li>
<li><strong>小端序</strong><ul>
<li>更符合計算機科學中的數學計算順序，因為最低有效位在前面更方便處理。（像是數據型態的轉換）</li>
</ul>
</li>
</ol>
<p>端序的部份我就大致介紹到這邊。如果對端序有興趣想要更深入了解的話，可以去看<a target="_blank" rel="noopener" href="https://blog.csdn.net/kevin_tech/article/details/113979523">這篇文章</a>！</p>
<h3 id="Python-Code-3"><a href="#Python-Code-3" class="headerlink" title="Python Code"></a>Python Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要雜湊的消息</span></span><br><span class="line">message = <span class="string">&quot;This is MD5!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 創建一個 MD5 雜湊對象</span></span><br><span class="line">md5_hash = hashlib.md5()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 將消息編碼後更新到雜湊對象中</span></span><br><span class="line">md5_hash.update(message.encode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 獲取雜湊值（十六進制表示）</span></span><br><span class="line">hash_hex = md5_hash.hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印雜湊值</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;MD5 value: <span class="subst">&#123;hash_hex&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="MD5-已死"><a href="#MD5-已死" class="headerlink" title="MD5 已死"></a>MD5 已死</h3><p>為甚麼說 MD5 已死呢？在 2004 年，中國的密碼學家王小雲和其研究同事發表了一篇論文，詳細描述了如何在不到一個小時內找到 MD5 的碰撞，同時這也證明了 MD5 是不安全的。</p>
<p>2012 年的時候密碼學研究人員 Marc Stevens 提出了一種更高效的 MD5 碰撞攻擊方法，稱為 Fast Collision Attack on MD5，他還開發了一個名為 HashClash 的工具，用於自動化生成 MD5 碰撞。</p>
<p>想更詳細的了解其原理，可以觀看以下影片！</p>
<div style="position: relative; width: 100%; height: 0; padding-bottom: 56.25%;">
    <iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://www.youtube.com/embed/aHeRBeJLjMI" frameborder="0" allowfullscreen></iframe>
</div>

<h2 id="SHA-256"><a href="#SHA-256" class="headerlink" title="SHA-256"></a>SHA-256</h2><h3 id="簡介-4"><a href="#簡介-4" class="headerlink" title="簡介"></a>簡介</h3><p>SHA(Secure Hash Algorithm)家族的雜湊函式是被美國聯邦資訊處理標準（FIPS）所認證的安全雜湊算法。他們（SHA 家族）是由美國國家安全局所設計，並由美國國家標準與技術研究院所發布的。他們家族中除了 SHA-256 以外還有 SHA-224、SHA-512 等等的雜湊函式，但這裡就主要講解最常見的 SHA-256。</p>
<p>SHA-256 和 MD5 其實流程是差不多的，大概的流程如下：</p>
<ol>
<li><p><strong>填充資料</strong></p>
<ul>
<li>將資料的末尾添加一個”1”，為了標記填充的開始</li>
<li>添加”0”位，直到資料的長度對 512 取模後等於 448。</li>
<li>最後，將資料的原始長度（以 Bit 為單位）附加到末尾，使得填充後的資料長度為 512 的倍數。</li>
</ul>
</li>
<li><p><strong>初始化緩衝區</strong></p>
<ul>
<li>SHA-256 使用八個 32 位元的變量來存儲中間和最終的雜湊值：<ul>
<li>h0 &#x3D; 0x6a09e667</li>
<li>h1 &#x3D; 0xbb67ae85</li>
<li>h2 &#x3D; 0x3c6ef372</li>
<li>h3 &#x3D; 0xa54ff53a</li>
<li>h4 &#x3D; 0x510e527f</li>
<li>h5 &#x3D; 0x9b05688c</li>
<li>h6 &#x3D; 0x1f83d9ab</li>
<li>h7 &#x3D; 0x5be0cd19</li>
</ul>
</li>
<li>是對自然數中前 8 個質數（2, 3, 5, 7, 11, 13, 17, 19）的平方根的小數部分取前 32 bits 而來。</li>
</ul>
</li>
<li><p><strong>處理資料</strong></p>
<ul>
<li><p>將填充後的資料以 512 位（64 Bytes）分成多個塊（Chunk）</p>
</li>
<li><p>對於每個 512 位的塊，再分為 16 個 32 位的小塊。</p>
</li>
<li><p>用這些 32 位的小塊和原本初始化好的 8 個變量進行迭代運算，由於過程太過於複雜，我會將其公式定義和圖解放在下面。</p>
<p>  $Ch(x, y, z) &#x3D; (x \land y) \oplus (\neg x \land z)$<br>  $Maj(x, y, z) &#x3D; (x \land y) \oplus (x \land z) \oplus (y \land z)$<br>  $\Sigma_0(x) &#x3D; S^2(x) \oplus S^{13}(x) \oplus S^{22}(x)$<br>  $\Sigma_1(x) &#x3D; S^6(x) \oplus S^{11}(x) \oplus S^{25}(x)$<br>  $\sigma_0(x) &#x3D; S^7(x) \oplus S^{18}(x) \oplus R^3(x)$<br>  $\sigma_1(x) &#x3D; S^{17}(x) \oplus S^{19}(x) \oplus R^{10}(x)$</p>
<p>  <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hackmd.io/_uploads/B1pTgx2U0.png" alt="SHA-256 workflow from Wikipedia"></p>
</li>
</ul>
</li>
<li><p>輸出最終哈希值</p>
<ul>
<li>當所有的 512 位塊都處理完成後，將 8 個變量 h0 到 h7 連接起來（大端序），形成最終的 256 位（32 字節）雜湊值。這個雜湊值即為輸入數據的 SHA-256 雜湊值。</li>
</ul>
</li>
</ol>
<h3 id="Python-Code-4"><a href="#Python-Code-4" class="headerlink" title="Python Code"></a>Python Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha256</span>(<span class="params">message</span>):</span><br><span class="line">    <span class="comment"># 將消息編碼為字節</span></span><br><span class="line">    message_bytes = message.encode()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 創建 SHA-256 雜湊對象</span></span><br><span class="line">    sha256_hash = hashlib.sha256()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 更新雜湊對象</span></span><br><span class="line">    sha256_hash.update(message_bytes)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 獲取雜湊值</span></span><br><span class="line">    hash_hex = sha256_hash.hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> hash_hex</span><br><span class="line"></span><br><span class="line"><span class="comment"># 測試 SHA-256 雜湊計算</span></span><br><span class="line">message = <span class="string">&quot;This is SHA-256!&quot;</span></span><br><span class="line">hash_result = sha256(message)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;SHA-256 Value: <span class="subst">&#123;hash_result&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="鹽-Salt"><a href="#鹽-Salt" class="headerlink" title="鹽 Salt"></a>鹽 Salt</h2><p>TODO</p>
<h1 id="古典密碼學-Classical-Cryptography"><a href="#古典密碼學-Classical-Cryptography" class="headerlink" title="古典密碼學 Classical Cryptography"></a>古典密碼學 Classical Cryptography</h1><p>古典密碼是指在計算機出現之前廣泛使用的密碼學技術。這些密碼技術通常基於簡單的替換或置換規則，而不涉及覆雜的數學運算。</p>
<p>儘管這些古典密碼在過去被廣泛使用，但它們都存在易受攻擊的缺陷，因此在現代密碼學中已經不再安全。現代密碼學使用基於覆雜數學運算和密鑰管理的加密算法來確保更高的安全性（且在現代密碼學中的觀點，他們更像是<strong>編碼</strong>而不是加密）。</p>
<p>以下是幾種常見的古典密碼。</p>
<h2 id="凱薩加密-Caesar-Cipher"><a href="#凱薩加密-Caesar-Cipher" class="headerlink" title="凱薩加密 Caesar Cipher"></a>凱薩加密 Caesar Cipher</h2><h3 id="簡介-5"><a href="#簡介-5" class="headerlink" title="簡介"></a>簡介</h3><p>凱撒密碼是一種簡單的替換密碼（Substitution cipher），通過將字母表中的每個字母向後（或向前）移動固定數量的位置來加密文本。例如，如果向後移動 3 個位置，則”A”加密為”D”，”B”加密為”E”，以此類推。</p>
<h3 id="Python-Code-5"><a href="#Python-Code-5" class="headerlink" title="Python Code"></a>Python Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_encrypt</span>(<span class="params">plaintext, key</span>):</span><br><span class="line">    ciphertext = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> plaintext:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():  <span class="comment"># 只對字母進行加密</span></span><br><span class="line">            shift = (</span><br><span class="line">                <span class="number">65</span> <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="number">97</span></span><br><span class="line">            )  <span class="comment"># 大寫字母對應 ASCII 表中的 65，小寫字母對應 97</span></span><br><span class="line">            encrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - shift + key) % <span class="number">26</span> + shift)</span><br><span class="line">            ciphertext += encrypted_char</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ciphertext += char  <span class="comment"># 非字母字符保持不變</span></span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    <span class="keyword">return</span> caesar_encrypt(ciphertext, -key)  <span class="comment"># 解密即加密的逆操作</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例明文和密鑰</span></span><br><span class="line">plaintext = <span class="string">&quot;This is the Caesar cipher&quot;</span></span><br><span class="line">key = <span class="number">14</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密明文</span></span><br><span class="line">encrypted_text = caesar_encrypt(plaintext, key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Encrypted:&quot;</span>, encrypted_text)</span><br></pre></td></tr></table></figure>

<h3 id="暴力破解-Brute-Force"><a href="#暴力破解-Brute-Force" class="headerlink" title="暴力破解 Brute Force"></a>暴力破解 Brute Force</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 嘗試所有可能的密鑰進行破解</span></span><br><span class="line"><span class="keyword">for</span> possible_key <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">26</span>):  <span class="comment"># 因為凱撒密碼只有 26 種可能的密鑰</span></span><br><span class="line">    decrypted_text = caesar_decrypt(encrypted_text, possible_key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Key <span class="subst">&#123;possible_key&#125;</span>: <span class="subst">&#123;decrypted_text&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="置換密碼-Transposition-Cipher"><a href="#置換密碼-Transposition-Cipher" class="headerlink" title="置換密碼 Transposition Cipher"></a>置換密碼 Transposition Cipher</h2><h3 id="簡介-6"><a href="#簡介-6" class="headerlink" title="簡介"></a>簡介</h3><p>置換密碼重新排列明文中的字母，而不改變字母本身。例如，列置換密碼將明文中的字母按列排列，然後按特定規則讀取以生成密文。</p>
<h2 id="維吉尼亞密碼-Vigenere-Cipher"><a href="#維吉尼亞密碼-Vigenere-Cipher" class="headerlink" title="維吉尼亞密碼 Vigenère Cipher"></a>維吉尼亞密碼 Vigenère Cipher</h2><h3 id="簡介-7"><a href="#簡介-7" class="headerlink" title="簡介"></a>簡介</h3><p>維吉尼亞密碼是一種多表替換密碼，它使用關鍵字來改變每個字母的替換規則。加密時，將明文的每個字母與關鍵字中的對應字母相結合來確定替換規則。</p>
<h2 id="柵欄密碼-Rail-Fence-Cipher"><a href="#柵欄密碼-Rail-Fence-Cipher" class="headerlink" title="柵欄密碼 Rail Fence Cipher"></a>柵欄密碼 Rail Fence Cipher</h2><h3 id="簡介-8"><a href="#簡介-8" class="headerlink" title="簡介"></a>簡介</h3><p>柵欄密碼將明文中的字母沿著特定的線排列，然後以不同的方式讀取以生成密文。例如，3 欄柵欄密碼將字母交替排列成三行，然後以從上到下、從左到右的順序讀取。</p>
<h1 id="對稱式加密-Symmetric-Cryptography"><a href="#對稱式加密-Symmetric-Cryptography" class="headerlink" title="對稱式加密 Symmetric Cryptography"></a>對稱式加密 Symmetric Cryptography</h1><p>TODO</p>
<h1 id="非對稱式加密-Asymmetric-Cryptography"><a href="#非對稱式加密-Asymmetric-Cryptography" class="headerlink" title="非對稱式加密 Asymmetric Cryptography"></a>非對稱式加密 Asymmetric Cryptography</h1><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><h3 id="RSA-介紹"><a href="#RSA-介紹" class="headerlink" title="RSA 介紹"></a>RSA 介紹</h3><h3 id="小公鑰指數攻擊（Low-public-exponent-attack）"><a href="#小公鑰指數攻擊（Low-public-exponent-attack）" class="headerlink" title="小公鑰指數攻擊（Low public exponent attack）"></a>小公鑰指數攻擊（Low public exponent attack）</h3><h3 id="Coppersmith’s-Attack"><a href="#Coppersmith’s-Attack" class="headerlink" title="Coppersmith’s Attack"></a>Coppersmith’s Attack</h3><h3 id="題目"><a href="#題目" class="headerlink" title="題目"></a>題目</h3></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="頭像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" title="頭像" alt="頭像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" title="頭像" alt="頭像"></a><div class="post-copyright__author_name">CX330</div><div class="post-copyright__author_desc">Hack the planet!</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="該文章爲原創文章，注意版權協議" href="https://cx330.tw/StudyNotes/Cryptography-Notes-%E5%AF%86%E7%A2%BC%E5%AD%B8%E4%BB%BB%E7%9D%A3%E4%BA%8C%E8%84%88/">原創</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://cx330.tw/StudyNotes/Cryptography-Notes-密碼學任督二脈/')">Cryptography Notes 密碼學任督二脈</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="讚賞作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打賞作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感謝你賜予我前進的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://buymeacoffee.com/cx330" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/buymeacoffee.png" alt="Buy Me a Coffee"/></a><div class="post-qr-code-desc">Buy Me a Coffee</div></li><li class="reward-item"><a href="https://cx330.tw" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" alt="CX330"/></a><div class="post-qr-code-desc">CX330</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">讚賞者名單</div><div class="reward-dec">因爲你們的支持讓我意識到寫文章的價值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="複製鏈接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本部落格所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 許可協議。轉載請註明來自 <a href="https://cx330.tw" target="_blank">CX330</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/CTF/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>CTF<span class="tagsPageCount">11</span></a><a class="post-meta__box__tags" href="/tags/Crypto/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Crypto<span class="tagsPageCount">3</span></a><a class="post-meta__box__tags" href="/tags/%E8%B3%87%E5%AE%89/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>資安<span class="tagsPageCount">5</span></a><a class="post-meta__box__tags" href="/tags/%E5%AF%86%E7%A2%BC%E5%AD%B8/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>密碼學<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E7%AD%86%E8%A8%98/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>筆記<span class="tagsPageCount">1</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024%20CTF%20Training/Day-01-Grinding-PicoCTF/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">[Day 01] Grinding PicoCTF</div></div></a></div><div class="next-post pull-right"><a href="/2024%20CTF%20Training/Day-02-Learning-Cryptography/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">[Day 02] Learning Cryptography</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>相關推薦</span></div><div class="relatedPosts-list"><div><a href="/2024%20CTF%20Training/Day-02-Learning-Cryptography/" title="[Day 02] Learning Cryptography"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-27</div><div class="title">[Day 02] Learning Cryptography</div></div></a></div><div><a href="/2024%20CTF%20Training/Day-03-Learning-Cryptography-2/" title="[Day 03] Learning Cryptography 2"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-28</div><div class="title">[Day 03] Learning Cryptography 2</div></div></a></div><div><a href="/2024%20CTF%20Training/Day-01-Grinding-PicoCTF/" title="[Day 01] Grinding PicoCTF"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-26</div><div class="title">[Day 01] Grinding PicoCTF</div></div></a></div><div><a href="/2024%20CTF%20Training/Day-05-Grinding-PicoCTF-3/" title="[Day 05] Grinding PicoCTF 3"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-01</div><div class="title">[Day 05] Grinding PicoCTF 3</div></div></a></div><div><a href="/2024%20CTF%20Training/Day-04-Grinding-PicoCTF-2/" title="[Day 04] Grinding PicoCTF 2"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-29</div><div class="title">[Day 04] Grinding PicoCTF 2</div></div></a></div><div><a href="/2024%20CTF%20Training/Day-06-Grinding-PicoCTF-4/" title="[Day 06] Grinding PicoCTF 4"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-02</div><div class="title">[Day 06] Grinding PicoCTF 4</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 評論</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)" style="display: none">匿名評論</a><a href="/privacy" style="margin-left: 4px">隱私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你無需刪除空行，直接評論以獲取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/sunglasses.png" alt="status"/></div></div><div class="author-info__description">這裡是CX330的部落格，記載了有關於CTF、資安、開發、程式設計等等的文章，也會記錄我個人的生活。相信你會在這邊找到有用的東西。</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">CX330</h1><div class="author-info__desc">Hack the planet!</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/CX330Blake" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://www.facebook.com/profile.php?id=100011698690769" target="_blank" title="Facebook"><i class="fa-brands fa-facebook faa-tada"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">English site at <a target="_blank" rel="noopener" href="https://en.cx330.tw" style="color:#f5a524;text-decoration:underline;font-weight:bold;">HERE</a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目錄</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%BA%E7%94%9A%E9%BA%BC%E6%9C%83%E6%83%B3%E5%AF%AB%E9%80%99%E7%AF%87%E6%96%87"><span class="toc-number">1.1.</span> <span class="toc-text">為甚麼會想寫這篇文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%AF%E5%85%8B%E9%9C%8D%E5%A4%AB%E5%8E%9F%E5%89%87-Kerckhoffs%E2%80%99s-principle"><span class="toc-number">1.2.</span> <span class="toc-text">柯克霍夫原則 Kerckhoffs’s principle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A0%98%E5%9F%9F%E5%B1%95%E9%96%8B%EF%BC%9A%E5%AF%86%E7%A2%BC%E5%AD%B8%E7%9A%84%E4%B8%89%E5%A4%A7%E9%A0%98%E5%9F%9F"><span class="toc-number">1.3.</span> <span class="toc-text">領域展開：密碼學的三大領域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B7%A8%E7%A2%BC-Encoding"><span class="toc-number">1.3.1.</span> <span class="toc-text">編碼 Encoding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%9C%E6%B9%8A-Hashing"><span class="toc-number">1.3.2.</span> <span class="toc-text">雜湊 Hashing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86-Encryption"><span class="toc-number">1.3.3.</span> <span class="toc-text">加密 Encryption</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E8%A6%8B%E7%B7%A8%E7%A2%BC-Common-Encoding"><span class="toc-number">2.</span> <span class="toc-text">常見編碼 Common Encoding</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ASCII-Encoding"><span class="toc-number">2.1.</span> <span class="toc-text">ASCII Encoding</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B"><span class="toc-number">2.1.1.</span> <span class="toc-text">簡介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-Code"><span class="toc-number">2.1.2.</span> <span class="toc-text">Python Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Base64-Encoding"><span class="toc-number">2.2.</span> <span class="toc-text">Base64 Encoding</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">簡介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">2.2.2.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-Code-1"><span class="toc-number">2.2.3.</span> <span class="toc-text">Python Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%B6%E4%BC%B8"><span class="toc-number">2.2.4.</span> <span class="toc-text">延伸</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#URL-Encoding"><span class="toc-number">2.3.</span> <span class="toc-text">URL Encoding</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B-2"><span class="toc-number">2.3.1.</span> <span class="toc-text">簡介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-Code-2"><span class="toc-number">2.3.2.</span> <span class="toc-text">Python Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%B5%90"><span class="toc-number">2.4.</span> <span class="toc-text">小結</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E8%A6%8B%E9%9B%9C%E6%B9%8A%E5%87%BD%E5%BC%8F-Common-Hash-Functions"><span class="toc-number">3.</span> <span class="toc-text">常見雜湊函式 Common Hash Functions</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MD5"><span class="toc-number">3.1.</span> <span class="toc-text">MD5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B-3"><span class="toc-number">3.1.1.</span> <span class="toc-text">簡介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%BA%8F-Endian"><span class="toc-number">3.1.2.</span> <span class="toc-text">端序 Endian</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-Code-3"><span class="toc-number">3.1.3.</span> <span class="toc-text">Python Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MD5-%E5%B7%B2%E6%AD%BB"><span class="toc-number">3.1.4.</span> <span class="toc-text">MD5 已死</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SHA-256"><span class="toc-number">3.2.</span> <span class="toc-text">SHA-256</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B-4"><span class="toc-number">3.2.1.</span> <span class="toc-text">簡介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-Code-4"><span class="toc-number">3.2.2.</span> <span class="toc-text">Python Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%B9%BD-Salt"><span class="toc-number">3.3.</span> <span class="toc-text">鹽 Salt</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A2%BC%E5%AD%B8-Classical-Cryptography"><span class="toc-number">4.</span> <span class="toc-text">古典密碼學 Classical Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%B1%E8%96%A9%E5%8A%A0%E5%AF%86-Caesar-Cipher"><span class="toc-number">4.1.</span> <span class="toc-text">凱薩加密 Caesar Cipher</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B-5"><span class="toc-number">4.1.1.</span> <span class="toc-text">簡介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-Code-5"><span class="toc-number">4.1.2.</span> <span class="toc-text">Python Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3-Brute-Force"><span class="toc-number">4.1.3.</span> <span class="toc-text">暴力破解 Brute Force</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%AE%E6%8F%9B%E5%AF%86%E7%A2%BC-Transposition-Cipher"><span class="toc-number">4.2.</span> <span class="toc-text">置換密碼 Transposition Cipher</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B-6"><span class="toc-number">4.2.1.</span> <span class="toc-text">簡介</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B6%AD%E5%90%89%E5%B0%BC%E4%BA%9E%E5%AF%86%E7%A2%BC-Vigenere-Cipher"><span class="toc-number">4.3.</span> <span class="toc-text">維吉尼亞密碼 Vigenère Cipher</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B-7"><span class="toc-number">4.3.1.</span> <span class="toc-text">簡介</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%B5%E6%AC%84%E5%AF%86%E7%A2%BC-Rail-Fence-Cipher"><span class="toc-number">4.4.</span> <span class="toc-text">柵欄密碼 Rail Fence Cipher</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B-8"><span class="toc-number">4.4.1.</span> <span class="toc-text">簡介</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%8D%E7%A8%B1%E5%BC%8F%E5%8A%A0%E5%AF%86-Symmetric-Cryptography"><span class="toc-number">5.</span> <span class="toc-text">對稱式加密 Symmetric Cryptography</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%9E%E5%B0%8D%E7%A8%B1%E5%BC%8F%E5%8A%A0%E5%AF%86-Asymmetric-Cryptography"><span class="toc-number">6.</span> <span class="toc-text">非對稱式加密 Asymmetric Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA"><span class="toc-number">6.1.</span> <span class="toc-text">RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-%E4%BB%8B%E7%B4%B9"><span class="toc-number">6.1.1.</span> <span class="toc-text">RSA 介紹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E5%85%AC%E9%91%B0%E6%8C%87%E6%95%B8%E6%94%BB%E6%93%8A%EF%BC%88Low-public-exponent-attack%EF%BC%89"><span class="toc-number">6.1.2.</span> <span class="toc-text">小公鑰指數攻擊（Low public exponent attack）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Coppersmith%E2%80%99s-Attack"><span class="toc-number">6.1.3.</span> <span class="toc-text">Coppersmith’s Attack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%8C%E7%9B%AE"><span class="toc-number">6.1.4.</span> <span class="toc-text">題目</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近發佈</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Hacking/Hacker-s-Manifesto-%E3%80%8A%E9%A7%AD%E5%AE%A2%E5%AE%A3%E8%A8%80%E3%80%8B/" title="Hacker's Manifesto《駭客宣言》"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_manifesto.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hacker's Manifesto《駭客宣言》"/></a><div class="content"><a class="title" href="/Hacking/Hacker-s-Manifesto-%E3%80%8A%E9%A7%AD%E5%AE%A2%E5%AE%A3%E8%A8%80%E3%80%8B/" title="Hacker's Manifesto《駭客宣言》">Hacker's Manifesto《駭客宣言》</a><time datetime="2024-07-07T10:11:39.000Z" title="發表於 2024-07-07 18:11:39">2024-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024%20CTF%20Training/Day-09-Grinding-PicoCTF-7/" title="[Day 09] Grinding PicoCTF 7"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[Day 09] Grinding PicoCTF 7"/></a><div class="content"><a class="title" href="/2024%20CTF%20Training/Day-09-Grinding-PicoCTF-7/" title="[Day 09] Grinding PicoCTF 7">[Day 09] Grinding PicoCTF 7</a><time datetime="2024-07-07T08:13:43.000Z" title="發表於 2024-07-07 16:13:43">2024-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024%20CTF%20Training/Day-08-Grinding-PicoCTF-6/" title="[Day 08] Grinding PicoCTF 6"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[Day 08] Grinding PicoCTF 6"/></a><div class="content"><a class="title" href="/2024%20CTF%20Training/Day-08-Grinding-PicoCTF-6/" title="[Day 08] Grinding PicoCTF 6">[Day 08] Grinding PicoCTF 6</a><time datetime="2024-07-06T09:24:11.000Z" title="發表於 2024-07-06 17:24:11">2024-07-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024%20CTF%20Training/Day-07-Grinding-PicoCTF-5/" title="[Day 07] Grinding PicoCTF 5"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[Day 07] Grinding PicoCTF 5"/></a><div class="content"><a class="title" href="/2024%20CTF%20Training/Day-07-Grinding-PicoCTF-5/" title="[Day 07] Grinding PicoCTF 5">[Day 07] Grinding PicoCTF 5</a><time datetime="2024-07-04T13:31:01.000Z" title="發表於 2024-07-04 21:31:01">2024-07-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024%20CTF%20Training/Day-06-Grinding-PicoCTF-4/" title="[Day 06] Grinding PicoCTF 4"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/hacker_in_the_universe.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[Day 06] Grinding PicoCTF 4"/></a><div class="content"><a class="title" href="/2024%20CTF%20Training/Day-06-Grinding-PicoCTF-4/" title="[Day 06] Grinding PicoCTF 4">[Day 06] Grinding PicoCTF 4</a><time datetime="2024-07-02T08:24:10.000Z" title="發表於 2024-07-02 16:24:10">2024-07-02</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/CX330Blake" title="GitHub"><i class="fa-brands fa-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100011698690769" title="Facebook"><i class="fa-brands fa-facebook"></i></a><a class="deal_link" href="mailto:timchen975@gmail.com" title="Email"><i class="fa-solid fa-envelope"></i></a><img class="footer_mini_logo" title="返回頂部" alt="返回頂部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%AD%90%E9%9B%8B-%E9%99%B3-11087825b/" title="LinkedIn"><i class="fa-brands fa-linkedin-in"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://discord.com/users/718263896187732049" title="Discord"><i class="fa-brands fa-discord"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.en" title="CC"><i class="fa-regular fa-copyright"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">文章導航</div><div class="footer-links"><a class="footer-item" title="總覽" href="/archives/">總覽</a><a class="footer-item" title="分類" href="/categories/">分類</a><a class="footer-item" title="標籤" href="/tags/">標籤</a></div></div><div class="footer-group"><div class="footer-title">社交中心</div><div class="footer-links"><a class="footer-item" title="友站" href="/link/">友站</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">我的</div><div class="footer-links"><a class="footer-item" title="音樂吧" href="/music/?id=7032963191&amp;server=netease">音樂吧</a><a class="footer-item" title="生活碎片" href="/essay/">生活碎片</a><a class="footer-item" title="書架" href="/notyet/">書架</a><a class="footer-item" title="相簿" href="/notyet/">相簿</a></div></div><div class="footer-group"><div class="footer-title">關於</div><div class="footer-links"><a class="footer-item" title="我是誰" href="/about/">我是誰</a><a class="footer-item" title="訂閱" href="/subscribe/">訂閱</a><a class="footer-item" title="支持我" target="_blank" rel="noopener" href="https://buymeacoffee.com/cx330">支持我</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友站</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="換一批友情鏈接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 By <a class="footer-bar-link" href="/" title="CX330" target="_blank">CX330</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#footer-type-tips", {
      strings: ["Yes, I am a criminal. My crime is that of curiosity.","Build the universe with me","Hack the planet!","Happy hacking"],
      startDelay: 300,
      typeSpeed: 200,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("footer-type-tips").innerHTML = 'Yes, I am a criminal. My crime is that of curiosity.'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="Theme">Theme</a><a class="footer-bar-link cc" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.en" title="cc協議"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/" title="tag"><div class="headline">標籤</div><div class="length-num">18</div></a><a href="/categories/" title="category"><div class="headline">分類</div><div class="length-num">6</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="顯示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>顯示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">聯絡</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100011698690769" title="Facebook"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/fb.png" alt="Facebook"/><span class="back-menu-item-text">Facebook</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.linkedin.com/in/%E5%AD%90%E9%9B%8B-%E9%99%B3-11087825b/" title="LinkedIn"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/linkedin.png" alt="LinkedIn"/><span class="back-menu-item-text">LinkedIn</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">English site</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://en.cx330.tw" title="CX330's Universe"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/me.jpg" alt="CX330's Universe"/><span class="back-menu-item-text">CX330's Universe</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-list-ul faa-tada" style="font-size: 0.9em;"></i><span> 總覽</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分類</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 標籤</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-dice faa-tada" style="font-size: 0.9em;"></i><span> 抽一篇</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 社交中心</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友站</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-message faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=7032963191&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音樂吧</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 生活碎片</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> Chasing</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相簿</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 關於</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 我是誰</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/subscribe/"><i class="anzhiyufont anzhiyu-icon-rss faa-tada" style="font-size: 0.9em;"></i><span> 訂閱</span></a></li></ul></div></div><span class="sidebar-menu-item-title">標籤</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/30%E5%A4%A9%E8%A8%88%E7%95%AB/" style="font-size: 0.88rem;">30天計畫<sup>9</sup></a><a href="/tags/AI/" style="font-size: 0.88rem;">AI<sup>1</sup></a><a href="/tags/AIS3/" style="font-size: 0.88rem;">AIS3<sup>1</sup></a><a href="/tags/Blog/" style="font-size: 0.88rem;">Blog<sup>1</sup></a><a href="/tags/CTF/" style="font-size: 0.88rem;">CTF<sup>11</sup></a><a href="/tags/Crypto/" style="font-size: 0.88rem;">Crypto<sup>3</sup></a><a href="/tags/Cryptography/" style="font-size: 0.88rem;">Cryptography<sup>2</sup></a><a href="/tags/CyberSec/" style="font-size: 0.88rem;">CyberSec<sup>9</sup></a><a href="/tags/GDSC/" style="font-size: 0.88rem;">GDSC<sup>1</sup></a><a href="/tags/Hacker/" style="font-size: 0.88rem;">Hacker<sup>1</sup></a><a href="/tags/PicoCTF/" style="font-size: 0.88rem;">PicoCTF<sup>8</sup></a><a href="/tags/SCIST/" style="font-size: 0.88rem;">SCIST<sup>1</sup></a><a href="/tags/Security/" style="font-size: 0.88rem;">Security<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A2%BC%E5%AD%B8/" style="font-size: 0.88rem;">密碼學<sup>1</sup></a><a href="/tags/%E7%AD%86%E8%A8%98/" style="font-size: 0.88rem;">筆記<sup>1</sup></a><a href="/tags/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC/" style="font-size: 0.88rem;">網頁開發<sup>1</sup></a><a href="/tags/%E8%B3%87%E5%AE%89/" style="font-size: 0.88rem;">資安<sup>5</sup></a><a href="/tags/%E9%A7%AD%E5%AE%A2/" style="font-size: 0.88rem;">駭客<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="閱讀模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="簡繁轉換">简</button><button id="darkmode" type="button" title="淺色和深色模式轉換"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="設定"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目錄"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直達評論"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="開關彈幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到頂部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音樂</a><div id="console-music-bg"></div><meting-js id="7032963191" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜尋</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  資料庫載入中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜尋文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>複製選中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘貼文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到評論</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打開</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>複製鏈接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>複製此圖片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下載此圖片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打開圖片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站內搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音樂</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切換到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切換到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/playlist?id=7032963191&amp;userid=6279304773&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>複製歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>隨便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分類</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章標籤</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>複製地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">關閉熱評</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>转为简体</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.cbd.int/mathjax@3.2.2/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://comments.cx330.tw/',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://comments.cx330.tw/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async src="/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[圖片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[連結]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[程式碼]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://comments.cx330.tw/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "無法獲取評論，請確認相關配置是否正確"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '沒有評論'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-PM5RRNPNEB', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>