var themeColorMeta,pageHeaderEl,navMusicEl,consoleEl,anzhiyu_musicFirst=!1,anzhiyu_keyboard=null,anzhiyu_musicPlaying=!1,$bodyWrap=document.getElementById("body-wrap"),anzhiyu_intype=!1,anzhiyu_keyUpEvent_timeoutId=null,anzhiyu_keyUpShiftDelayEvent_timeoutId=null,rm=null,popupWindowTimer=null,adjectives=["美麗的","英俊的","聰明的","勇敢的","可愛的","慷慨的","善良的","可靠的","開朗的","成熟的","穩重的","真誠的","幽默的","豁達的","有趣的","活潑的","優雅的","敏捷的","溫柔的","溫暖的","敬業的","細心的","耐心的","深沉的","樸素的","含蓄的","率直的","開放的","務實的","堅強的","自信的","謙虛的","文靜的","深刻的","純真的","朝氣蓬勃的","慎重的","大方的","頑強的","迷人的","機智的","善解人意的","富有想象力的","有魅力的","獨立的","好奇的","乾淨的","寬容的","尊重他人的","體貼的","守信的","有耐性的","有責任心的","有擔當的","有遠見的","有智慧的","有眼光的","有冒險精神的","有愛心的","有同情心的","喜歡思考的","喜歡學習的","具有批判性思維的","善於表達的","善於溝通的","善於合作的","善於領導的","有激情的","有幽默感的","有思想的","有個性的","有正義感的","有責任感的","有創造力的","有想象力的","有藝術細胞的","有團隊精神的","有協調能力的","有決策能力的","有組織能力的","有學習能力的","有執行能力的","有分析能力的","有邏輯思維的","有創新能力的","有專業素養的","有商業頭腦的"],vegetablesAndFruits=["蘿蔔","白菜","芹菜","生菜","青椒","辣椒","茄子","豆角","黃瓜","西紅柿","洋蔥","大蒜","土豆","南瓜","豆腐","韭菜","花菜","西蘭花","蘑菇","金針菇","蘋果","香蕉","橙子","檸檬","獼猴桃","草莓","葡萄","桃子","杏子","李子","石榴","西瓜","哈密瓜","蜜瓜","櫻桃","藍莓","柿子","橄欖","柚子","火龍果"],selectRandomSong=[],musicVolume=.8,changeMusicListFlag=!1,defaultPlayMusicList=[];document.addEventListener("DOMContentLoaded",function(){let n,a,e,t=!1,l=e=>{var t=e=>Array.from(e).reduce((e,t)=>e+t.offsetWidth,0),e=(e&&(e=t(document.querySelector("#blog_name > a").children),t=t(document.getElementById("menus").children),n=e+t,a=document.getElementById("nav")),window.innerWidth<=768||n>a.offsetWidth-120);a.classList.toggle("hide-menu",e)},d={open:()=>{anzhiyu.sidebarPaddingR(),anzhiyu.animateIn(document.getElementById("menu-mask"),"to_show 0.5s"),document.getElementById("sidebar-menus").classList.add("open"),t=!0},close:()=>{document.body.style.paddingRight="",anzhiyu.animateOut(document.getElementById("menu-mask"),"to_hide 0.5s"),document.getElementById("sidebar-menus").classList.remove("open"),t=!1}};function c(e){let l=e=>{let i="",a=e=>e.replace(/"/g,"&quot;");return e.forEach(e=>{var t=e.alt?`alt="${a(e.alt)}"`:"",n=e.title?`title="${a(e.title)}"`:"",o=e.address||"",o=`
        <div class="fj-gallery-item">
          ${o?`<div class="tag-address">${o}</div>`:""}
          <img src="${e.url}" ${t+n}>
        </div>
      `;i+=o}),i},r=(e,t,n)=>{var n=Number(n),o=t.length;return n<o?e.insertAdjacentHTML("beforeend",l(t.splice(0,n))):(e.insertAdjacentHTML("beforeend",l(t)),e.classList.remove("lazyload")),window.lazyLoadInstance&&window.lazyLoadInstance.update(),n<o?n:o},n=(o,i)=>{let a=o.getAttribute("data-limit")??i.length;if(!o.classList.contains("lazyload")||i.length<a)o.innerHTML=l(i),o.nextElementSibling.style.display="none";else if(!o.classList.contains("btn_album_detail_lazyload")||o.classList.contains("page_img_lazyload")){r(o,i,a);let n=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&setTimeout((e=r(o,i,a),fjGallery(o,"appendImages",o.querySelectorAll(`.fj-gallery-item:nth-last-child(-n+${e})`)),anzhiyu.loadLightbox(o.querySelectorAll("img")),void(e<Number(a)&&n.unobserve(o.nextElementSibling))),100)})});n.observe(o.nextElementSibling)}else{r(o,i,a);let t=()=>{var e=r(o,i,a);fjGallery(o,"appendImages",o.querySelectorAll(`.fj-gallery-item:nth-last-child(-n+${e})`)),anzhiyu.loadLightbox(o.querySelectorAll("img")),e<a&&o.nextElementSibling.removeEventListener("click",t)};o.nextElementSibling.addEventListener("click",t)}anzhiyu.initJustifiedGallery(o),anzhiyu.loadLightbox(o.querySelectorAll("img")),window.lazyLoadInstance&&window.lazyLoadInstance.update()};var t=()=>{e.forEach(t=>{t.classList.contains("url")?(async e=>{return(await fetch(e)).json()})(t.textContent).then(e=>{n(t,e)}):n(t,JSON.parse(t.textContent))})};window.fjGallery?t():(getCSS(""+GLOBAL_CONFIG.source.justifiedGallery.css),getScript(""+GLOBAL_CONFIG.source.justifiedGallery.js).then(t))}function u(){let o=document.getElementById("rightside"),i=window.innerHeight+56,a=0,l=(document.body.scrollHeight<=i&&(o.style.cssText="opacity: 1; transform: translateX(-58px)"),0),r=!0,s=document.getElementById("page-header"),d=document.getElementById("popup-window"),c="function"==typeof chatBtnHide,u="function"==typeof chatBtnShow,m=!1,e=document.getElementById("nav-music"),t=document.getElementById("footer"),y=document.getElementById("waterfall"),h=document.getElementById("percent"),g=document.getElementById("nav-totop"),p=document.getElementById("body-wrap"),L=document.getElementById("post-comment")||document.getElementById("footer");function v(e){var t=p.clientHeight,n=document.documentElement.clientHeight,t=n<t?t-n:document.documentElement.scrollHeight-n,n=Math.round(100*(e/t)),t=100<n?100:n<=0?1:n;h.textContent=t,function(e){if(e){var t=window.getComputedStyle(e).getPropertyValue("display");if("none"!=t)return t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e.offsetTop-document.documentElement.scrollTop<=t}}(L||90<t)&&20<e?(g.classList.add("long"),h.textContent="返回頂部"):(g.classList.remove("long"),h.textContent=t),y&&(n=e%document.documentElement.clientHeight,!m&&100+n>=document.documentElement.clientHeight?(console.info(n,document.documentElement.clientHeight),setTimeout(()=>{waterfall("#waterfall")},500)):setTimeout(()=>{y&&waterfall("#waterfall")},500))}var n=anzhiyu.throttle(()=>{var e=window.scrollY||document.documentElement.scrollTop,t=(n=(t=e)>l,l=t,n),n=Math.abs(a-e);60<e&&n<20&&0!=n||(d&&d.classList.contains("show-popup-window")&&60<e&&20<n&&0!=a&&anzhiyu.throttle(()=>{popupWindowTimer&&clearTimeout(popupWindowTimer),popupWindowTimer=setTimeout(()=>{d.classList.contains("popup-hide")||d.classList.add("popup-hide"),setTimeout(()=>{d.classList.remove("popup-hide"),d.classList.remove("show-popup-window")},1e3)},1e3)},1e3)(),26<(a=e)?(t?(s.classList.contains("nav-visible")&&s.classList.remove("nav-visible"),u&&!0===r&&(chatBtnHide(),r=!1)):(s.classList.contains("nav-visible")||s.classList.add("nav-visible"),c&&!1===r&&(chatBtnShow(),r=!0)),requestAnimationFrame(()=>{anzhiyu.initThemeColor(),s.classList.add("nav-fixed")}),"0"===window.getComputedStyle(o).getPropertyValue("opacity")&&(o.style.cssText="opacity: 0.8; transform: translateX(-58px)")):(e<=5&&requestAnimationFrame(()=>{s.classList.remove("nav-fixed"),s.classList.remove("nav-visible"),anzhiyu.initThemeColor()}),o.style.cssText="opacity: ''; transform: ''"),document.body.scrollHeight<=i&&(o.style.cssText="opacity: 0.8; transform: translateX(-58px)"),v(e))},96);t&&anzhiyu.intersectionObserver(()=>{t&&e&&768<document.body.clientWidth&&(e.style.bottom="-10px",e.style.opacity="0"),m=!0},()=>{t&&e&&768<document.body.clientWidth&&(e.style.bottom="20px",e.style.opacity="1")})().observe(t),n(),anzhiyu.addEventListenerPjax(window,"scroll",n,{passive:!0})}function m(){let d=GLOBAL_CONFIG_SITE.isToc,c=GLOBAL_CONFIG.isAnchor;var o=document.getElementById("article-container");if(o&&(d||c)){let e,a,l,r;if(d){let n=document.getElementById("card-toc");a=n.querySelector(".toc-content"),e=a.querySelectorAll(".toc-link"),r=a.classList.contains("is-expand");anzhiyu.addEventListenerPjax(a,"click",e=>{var t=e.target.closest(".toc-link");t&&(e.preventDefault(),anzhiyu.scrollToDest(anzhiyu.getEleTop(document.getElementById(decodeURI(t.getAttribute("href")).replace("#","")))-60,300),window.innerWidth<900)&&n.classList.remove("open")}),l=e=>{var e=e.getBoundingClientRect().top,t=a.scrollTop;e>document.documentElement.clientHeight-100&&(a.scrollTop=t+150),e<100&&(a.scrollTop=t-150)}}o=o.querySelectorAll("h1,h2,h3,h4,h5,h6");let t=Array.from(o).filter(e=>"CrawlerTitle"!==e.id),s="",n=function(n){if(0===n)return!1;let o="",i="";if(t.forEach(function(e,t){n>anzhiyu.getEleTop(e)-80&&(e=e.id,o=e?"#"+encodeURI(e):"",i=t)}),s!==i&&(c&&anzhiyu.updateAnchor(o),s=i,d)&&(a.querySelectorAll(".active").forEach(e=>{e.classList.remove("active")}),""!==o)){let t=e[i];if(t.classList.add("active"),setTimeout(()=>{l(t)},0),!r){let e=t.parentNode;for(;!e.matches(".toc");e=e.parentNode)e.matches("li")&&e.classList.add("active")}}};o=anzhiyu.throttle(()=>{var e=window.scrollY||document.documentElement.scrollTop;n(e)},100);anzhiyu.addEventListenerPjax(window,"scroll",o,{passive:!0})}}function y(e){e.forEach(e=>{var t=e.getAttribute("datetime");e.textContent=anzhiyu.diffDate(t,!0),e.style.display="inline"})}let o=t=>{let n=(window.globalFn||{}).themeChange||{};n&&(Object.keys(n).forEach(e=>{(0,n[e])(t)}),rm&&rm.hideRightMenu(),e.querySelector(".menu-darkmode-text").textContent="light"===t?"深色模式":"淺色模式",GLOBAL_CONFIG_SITE.isPost||(document.querySelector(":root").style.setProperty("--anzhiyu-bar-background","var(--anzhiyu-meta-theme-color)"),requestAnimationFrame(()=>{anzhiyu.initThemeColor()}),document.documentElement.style.setProperty("--anzhiyu-main",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-theme")),document.documentElement.style.setProperty("--anzhiyu-theme-op",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"23"),document.documentElement.style.setProperty("--anzhiyu-theme-op-deep",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"dd")))},r={readmode:()=>{let e=document.body,t=(e.classList.add("read-mode"),document.createElement("button")),n=(t.type="button",t.className="anzhiyufont anzhiyu-icon-xmark exit-readmode",e.appendChild(t),()=>{e.classList.remove("read-mode"),t.remove(),t.removeEventListener("click",n)});t.addEventListener("click",n)},darkmode:()=>{var e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";"dark"==e?(activateDarkMode(),void 0!==GLOBAL_CONFIG.Snackbar&&anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),void 0!==GLOBAL_CONFIG.Snackbar&&anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),saveToLocal.set("theme",e,2),o(e)},"rightside-config":e=>{let t=e.firstElementChild;t.classList.contains("show")&&(t.classList.add("status"),setTimeout(()=>{t.classList.remove("status")},300)),t.classList.toggle("show")},"go-up":()=>{anzhiyu.scrollToDest(0,500)},"hide-aside-btn":()=>{var e=document.documentElement.classList,t=e.contains("hide-aside")?"show":"hide";saveToLocal.set("aside-status",t,2),e.toggle("hide-aside")},"mobile-toc-button":e=>{let t=document.getElementById("card-toc");t.style.transformOrigin=`right ${e.getBoundingClientRect().top+17}px`,t.style.transition="transform 0.3s ease-in-out",t.classList.toggle("open"),t.addEventListener("transitionend",()=>{t.style.transition="",t.style.transformOrigin=""},{once:!0})},"chat-btn":()=>{window.chatBtnFn()},translateLink:()=>{window.translateFn.translatePage()}},h=(document.getElementById("rightside").addEventListener("click",function(e){e=e.target.closest("[id]");e&&r[e.id]&&r[e.id](this)}),document.addEventListener("touchstart",e=>{anzhiyu.removeRewardMask()},{passive:!0}),()=>{var e=document.querySelectorAll("#article-container .tabs");if(e.length){let i=(e,t)=>{Array.from(e).forEach(e=>{e.classList.remove("active"),e!==t&&e.id!==t||e.classList.add("active")})};e.forEach(e=>{var n,t,o=!!e.querySelectorAll(".gallery-container");n=o,anzhiyu.addEventListenerPjax(e.firstElementChild,"click",function(e){var t,e=e.target.closest("button");e.classList.contains("active")||(i(this.children,e),this.classList.remove("no-default"),e=e.getAttribute("data-href"),t=this.nextElementSibling,i(t.children,e),n&&0<(t=t.querySelectorAll(`#${e} .fj-gallery`)).length&&anzhiyu.initJustifiedGallery(t))}),t=e,anzhiyu.addEventListenerPjax(t.lastElementChild,"click",e=>{e.target.closest("button")&&anzhiyu.scrollToDest(anzhiyu.getEleTop(t),300)})})}}),g=e=>{return/^(rgb|RGB)/.test(e)?e.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(",").reduce((e,t)=>{return e+Number(t).toString(16).padStart(2,"0")},"#"):/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/.test(e)&&4===e.length?Array.from(e.slice(1)).reduce((e,t)=>e+t+t,"#"):e},v=(e,t)=>{var n=e.startsWith("#"),e=(n&&(e=e.slice(1)),parseInt(e,16)),o=(e,t)=>255<(e+=t)?255:e<0?0:e,i=o(e>>16,t),a=o(e>>8&255,t),o=o(255&e,t);return(n?"#":"")+String("000000"+(o|a<<8|i<<16).toString(16)).slice(-6)},E=e=>{var[,e,t,n]=(e=>{e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,n,o)=>t+t+n+n+o+o);e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return e?`rgb(${parseInt(e[1],16)}, ${parseInt(e[2],16)}, ${parseInt(e[3],16)})`:null})(e).match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return.5<=(299*e+587*t+114*n)/255e3?"light":"dark"};function i(){Promise.all([{url:"https://sdk.51.la/js-sdk-pro.min.js",charset:"UTF-8",crossorigin:!1,id:"LA_COLLECT"},{url:"https://sdk.51.la/perf/js-sdk-perf.min.js",crossorigin:"anonymous"}].map(({url:e,charset:t,crossorigin:n,id:o})=>{return[i,a="UTF-8",l,r]=[e,t,n,o],new Promise((t,e)=>{let n=document.createElement("script");n.src=i,n.async=!0,r&&n.setAttribute("id",r),a&&n.setAttribute("charset",a),l&&n.setAttribute("crossorigin",l),n.onerror=e,n.onload=n.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)});var i,a,l,r})).then(()=>{LA.init({id:GLOBAL_CONFIG.LA51.ck,ck:GLOBAL_CONFIG.LA51.ck}),(new LingQue.Monitor).init({id:GLOBAL_CONFIG.LA51.LingQueMonitorID,sendSuspicious:!0})}).catch(e=>{console.error("加載51a統計異常，本地加載403是正常情況:",e)})}function f(e,t){e=document.getElementById(e);e&&t?(t=e.querySelector(t))&&t.addEventListener("click",r.darkmode):e&&e.addEventListener("click",r.darkmode)}window.onkeydown=function(e){123===e.keyCode&&anzhiyu.snackbarShow("開發者模式已打開，請遵循GPL協議",!1)};if(window.refreshFn=function(){var e,t,n,o;if(l(!0),a.classList.add("show"),themeColorMeta=document.querySelector('meta[name="theme-color"]'),pageHeaderEl=document.getElementById("page-header"),navMusicEl=document.getElementById("nav-music"),consoleEl=document.getElementById("console"),f("console",".darkmode_switchbutton"),GLOBAL_CONFIG_SITE.isPost?(void 0!==GLOBAL_CONFIG.noticeOutdate&&(n=GLOBAL_CONFIG.noticeOutdate,(o=anzhiyu.diffDate(GLOBAL_CONFIG_SITE.postUpdate))>=n.limitDay)&&((t=document.createElement("div")).className="post-outdate-notice",t.textContent=n.messagePrev+" "+o+" "+n.messageNext,o=document.getElementById("article-container"),"top"===n.position?o.insertBefore(t,o.firstChild):o.appendChild(t)),GLOBAL_CONFIG.relativeDate.post&&y(document.querySelectorAll("#post-meta time"))):((GLOBAL_CONFIG.relativeDate.homepage||GLOBAL_CONFIG.relativeDate.simplehomepage)&&y(document.querySelectorAll("#recent-posts time")),GLOBAL_CONFIG.runtime&&(n=document.getElementById("runtimeshow"))&&(o=n.getAttribute("data-publishDate"),n.textContent=anzhiyu.diffDate(o)+" "+GLOBAL_CONFIG.runtime),(t=document.getElementById("last-push-date"))&&(e=t.getAttribute("data-lastPushDate"),t.textContent=anzhiyu.diffDate(e,!0)),(e=document.querySelector("#aside-cat-list.expandBtn"))&&anzhiyu.addEventListenerPjax(e,"click",e=>{var t=e.target;"I"===t.nodeName&&(e.preventDefault(),t.parentNode.classList.toggle("expand"))},!0)),GLOBAL_CONFIG.diytitle){let e=GLOBAL_CONFIG.diytitle.leaveTitle,t=GLOBAL_CONFIG.diytitle.backTitle,n=document.title,o;document.addEventListener("visibilitychange",function(){document.hidden?(document.title=e,clearTimeout(o)):(document.title=t+n,o=setTimeout(function(){document.title=n},2e3))})}m(),GLOBAL_CONFIG_SITE.isHome&&(p=document.getElementById("scroll-down"))&&anzhiyu.addEventListenerPjax(p,"click",()=>{var e=document.getElementById("bbTimeList");e?anzhiyu.scrollToDest(e.offsetTop-62,300):anzhiyu.scrollToDest(document.getElementById("home_top").offsetTop-60,300)});var p=GLOBAL_CONFIG.highlight;if(p){let{highlightCopy:e,highlightLang:m,highlightHeightLimit:y,plugin:h}=p;p=GLOBAL_CONFIG_SITE.isHighlightShrink;let g=e||m||void 0!==p;var L="highlight.js"===h?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if((g||y)&&L.length){let a="prismjs"===h,l=!0===p?"closed":"",r=void 0!==p?'<i class="anzhiyufont anzhiyu-icon-angle-down expand ${highlightShrinkClass}"></i>':"",s=e?'<div class="copy-notice"></div><i class="anzhiyufont anzhiyu-icon-paste copy-button"></i>':"",t=(t,n)=>{if(void 0!==GLOBAL_CONFIG.Snackbar)anzhiyu.snackbarShow(n);else{let e=t.previousElementSibling;e.textContent=n,e.style.opacity=1,setTimeout(()=>{e.style.opacity=0},800)}},d=e=>{document.queryCommandSupported&&document.queryCommandSupported("copy")?(document.execCommand("copy"),t(e,GLOBAL_CONFIG.copy.success)):t(e,GLOBAL_CONFIG.copy.noSupport)},n=e=>{var t=e.parentNode,n=(t.classList.add("copy-true"),window.getSelection()),o=document.createRange(),i=a?"pre code":"table .code pre";o.selectNodeContents(t.querySelectorAll(i)[0]),n.removeAllRanges(),n.addRange(o),d(e.lastChild),n.removeAllRanges(),t.classList.remove("copy-true")},o=e=>{e.classList.toggle("closed")},c=function(e){e=e.target.classList;e.contains("expand")?o(this):e.contains("copy-button")&&n(this)},u=function(){this.classList.toggle("expand-done")},i=(e,t,n)=>{var o,i=document.createDocumentFragment();g&&((o=document.createElement("div")).className="highlight-tools "+l,o.innerHTML=r+e+s,anzhiyu.addEventListenerPjax(o,"click",c),i.appendChild(o)),y&&t.offsetHeight>y+30&&((e=document.createElement("div")).className="code-expand-btn",e.innerHTML='<i class="anzhiyufont anzhiyu-icon-angle-double-down"></i>',anzhiyu.addEventListenerPjax(e,"click",u),i.appendChild(e)),"hl"===n?t.insertBefore(i,t.firstChild):t.parentNode.insertBefore(i,t)};a?L.forEach(e=>{var t;m?(t=`<div class="code-lang">${e.getAttribute("data-language")||"Code"}</div>`,anzhiyu.wrap(e,"figure",{class:"highlight"}),i(t,e)):(anzhiyu.wrap(e,"figure",{class:"highlight"}),i("",e))}):L.forEach(t=>{if(m){let e=t.getAttribute("class").split(" ")[1];var n=`<div class="code-lang">${e="plain"!==e&&void 0!==e?e:"Code"}</div>`;i(n,t,"hl")}else i("",t,"hl")})}}GLOBAL_CONFIG.isPhotoFigcaption&&document.querySelectorAll("#article-container img").forEach(function(e){var t,n=e.parentNode,o=e.title||e.alt;o&&!n.parentNode.classList.contains("justified-gallery")&&((t=document.createElement("div")).className="img-alt is-center",t.textContent=o,n.insertBefore(t,e.nextSibling))}),u(),window.scrollCollect&&window.scrollCollect();var L=document.querySelectorAll("#content-inner .fj-gallery"),i=(L.length&&c(L),anzhiyu.loadLightbox(document.querySelectorAll("#article-container img:not(.no-lightbox)")),(i=document.querySelectorAll("#article-container table")).length&&i.forEach(e=>{e.closest(".highlight")||anzhiyu.wrap(e,"div",{class:"table-wrap"})}),document.querySelectorAll("#article-container .hide-button"));if(i.length){let t=function(e){this.classList.add("open");var t=this.nextElementSibling.querySelectorAll(".gallery-container");t.length&&addJustifiedGallery(t)};i.forEach(e=>{e.addEventListener("click",t,{once:!0})})}h();var i=document.getElementById("switch-btn");if(i){let e=!1,t=document.getElementById("post-comment");anzhiyu.addEventListenerPjax(i,"click",()=>{t.classList.toggle("move"),e||"function"!=typeof loadOtherComment||(e=!0,loadOtherComment())})}if(document.getElementById("toggle-menu").addEventListener("click",()=>{d.open()}),document.getElementById("post-comment")){let t=1,n="",a=document.createElement("div"),l=(a.id="owo-big",document.querySelector("body"));function r(i){"IMG"==i.target.tagName&&t&&(t=0,n=setTimeout(()=>{var e=3*i.target.clientHeight,t=3*i.target.clientWidth;let n=i.x-i.offsetX-(t-i.target.clientWidth)/2;n+t>l.clientWidth&&(n-=n+t-l.clientWidth+10),n<0&&(n=10);var o=i.y-i.offsetY;a.style.height=e+"px",a.style.width=t+"px",a.style.left=n+"px",a.style.top=o+"px",a.style.display="flex",a.innerHTML=`<img src="${i.target.src}">`},100))}function s(e){a.style.display="none",t=1,clearTimeout(n)}l.appendChild(a),new MutationObserver(e=>{e.forEach(e=>{var t=e.addedNodes;for(let e=0;e<t.length;e++){var n=t[e];n.nodeType===Node.ELEMENT_NODE&&n.classList.contains("OwO-body")&&!n.classList.contains("comment-barrage")&&((n=n).addEventListener("contextmenu",e=>e.preventDefault()),n.addEventListener("mouseover",r),n.addEventListener("mouseout",s))}})}).observe(document.getElementById("post-comment"),{childList:!0,subtree:!0})}(i=document.querySelector(".topGroup"))&&i.addEventListener("mouseleave",function(){document.getElementById("todayCard").classList.remove("hide"),document.getElementById("todayCard").style.zIndex=1}),(async()=>{var t=document.querySelector(":root"),n=document.getElementById("post-top-bg")?.src;if(n){if(GLOBAL_CONFIG.mainTone)if(GLOBAL_CONFIG_SITE.postMainColor){let e=GLOBAL_CONFIG_SITE.postMainColor;"light"===E(e)&&(e=v(g(e),-40)),t.style.setProperty("--anzhiyu-bar-background",e),requestAnimationFrame(()=>{anzhiyu.initThemeColor()}),GLOBAL_CONFIG.mainTone.cover_change&&(document.documentElement.style.setProperty("--anzhiyu-main",e),document.documentElement.style.setProperty("--anzhiyu-theme-op",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"23"),document.documentElement.style.setProperty("--anzhiyu-theme-op-deep",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"dd"))}else{var o="var(--anzhiyu-theme)";let e="";"cdn"==GLOBAL_CONFIG.mainTone.mode||"both"==GLOBAL_CONFIG.mainTone.mode?e=n+"?imageAve":"api"==GLOBAL_CONFIG.mainTone.mode&&(e=GLOBAL_CONFIG.mainTone.api+n);try{var i=await fetch(e);if(i.ok&&i.headers.get("content-type")?.includes("application/json")){var a=await i.json();let e="cdn"==GLOBAL_CONFIG.mainTone.mode||"both"==GLOBAL_CONFIG.mainTone.mode?"#"+a.RGB.slice(2):a.RGB;"light"===E(e)&&(e=v(g(e),-40)),t.style.setProperty("--anzhiyu-bar-background",e),requestAnimationFrame(()=>{anzhiyu.initThemeColor()}),GLOBAL_CONFIG.mainTone.cover_change&&(document.documentElement.style.setProperty("--anzhiyu-main",e),document.documentElement.style.setProperty("--anzhiyu-theme-op",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"23"),document.documentElement.style.setProperty("--anzhiyu-theme-op-deep",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"dd"))}else if("both"==GLOBAL_CONFIG.mainTone.mode)try{var l=await fetch(GLOBAL_CONFIG.mainTone.api+n);if(l.ok&&l.headers.get("content-type")?.includes("application/json")){let e=(await l.json()).RGB;"light"===E(e)&&(e=v(g(e),-40)),t.style.setProperty("--anzhiyu-bar-background",e),requestAnimationFrame(()=>{anzhiyu.initThemeColor()}),GLOBAL_CONFIG.mainTone.cover_change&&(document.documentElement.style.setProperty("--anzhiyu-main",e),document.documentElement.style.setProperty("--anzhiyu-theme-op",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"23"),document.documentElement.style.setProperty("--anzhiyu-theme-op-deep",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"dd"))}else t.style.setProperty("--anzhiyu-bar-background",o),requestAnimationFrame(()=>{anzhiyu.initThemeColor()}),document.documentElement.style.setProperty("--anzhiyu-main",o)}catch{t.style.setProperty("--anzhiyu-bar-background",o),requestAnimationFrame(()=>{anzhiyu.initThemeColor()}),document.documentElement.style.setProperty("--anzhiyu-main",o)}else t.style.setProperty("--anzhiyu-bar-background",o),requestAnimationFrame(()=>{anzhiyu.initThemeColor()}),document.documentElement.style.setProperty("--anzhiyu-main",o)}catch(e){console.error("Error fetching data:",e),t.style.setProperty("--anzhiyu-bar-background",o),requestAnimationFrame(()=>{anzhiyu.initThemeColor()}),document.documentElement.style.setProperty("--anzhiyu-main",o)}}}else t.style.setProperty("--anzhiyu-bar-background","var(--anzhiyu-meta-theme-color)"),requestAnimationFrame(()=>{anzhiyu.initThemeColor()}),document.documentElement.style.setProperty("--anzhiyu-main",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-theme")),document.documentElement.style.setProperty("--anzhiyu-theme-op",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"23"),document.documentElement.style.setProperty("--anzhiyu-theme-op-deep",getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-main")+"dd")})(),(i=document.getElementById("toPageText"))&&i.addEventListener("keydown",e=>{13===e.keyCode&&(anzhiyu.toPage(),e=document.getElementById("toPageButton").href,pjax.loadUrl(e))}),anzhiyu.addEventListenerPjax(document.getElementById("toggle-menu"),"click",()=>{d.open()}),document.getElementById("page-name").innerText=document.title.split(" | "+GLOBAL_CONFIG_SITE.configTitle)[0],anzhiyu.initIndexEssay(),anzhiyu.changeTimeInEssay(),anzhiyu.removeBodyPaceClass(),anzhiyu.qrcodeCreate(),anzhiyu.changeTimeInAlbumDetail(),anzhiyu.reflashEssayWaterFall(),anzhiyu.sayhi(),anzhiyu.stopImgRightDrag(),anzhiyu.addNavBackgroundInit(),anzhiyu.setValueToBodyType(),anzhiyu.catalogActive(),anzhiyu.tagsPageActive(),anzhiyu.categoriesBarActive(),anzhiyu.topCategoriesBarScroll(),anzhiyu.switchRightClickMenuHotReview(),anzhiyu.getCustomPlayList(),anzhiyu.addEventListenerConsoleMusicList(!1),anzhiyu.initPaginationObserver(),setTimeout(()=>{var e;e=document.querySelectorAll("input, textarea"),Array.from(e).filter(e=>{"center-console"===e.id&&e.id}).forEach(e=>{e.addEventListener("focus",()=>{anzhiyu_intype=!0}),e.addEventListener("blur",()=>{anzhiyu_intype=!1})}),"function"==typeof addFriendLinksInFooter&&addFriendLinksInFooter()},200)},refreshFn(),window.addEventListener("resize",()=>{l(!1),t&&anzhiyu.isHidden(document.getElementById("toggle-menu"))&&d.close()}),document.getElementById("menu-mask").addEventListener("click",e=>{d.close()}),e=document.getElementById("rightMenu"),f("menu-darkmode"),f("sidebar",".darkmode_switchbutton"),document.querySelector("#sidebar-menus .menus_items")&&document.querySelector("#sidebar-menus .menus_items").addEventListener("click",e=>{e=e.target.closest(".site-page.group");e&&e.classList.toggle("hide")}),GLOBAL_CONFIG.islazyload&&(window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src"})),void 0!==GLOBAL_CONFIG.copyright){let{limitCount:o,languages:i,copy:e,copyrightEbable:a}=GLOBAL_CONFIG.copyright;document.body.addEventListener("copy",t=>{if(e&&anzhiyu.snackbarShow(i.copySuccess),a){t.preventDefault();var n=window.getSelection(0).toString();let e=n;return n.length>o&&(e=`${n}


${i.author}
${i.link}${window.location.href}
${i.source}
`+i.info),(t.clipboardData?t:window).clipboardData.setData("text",e)}})}if(GLOBAL_CONFIG.navMusic){let e=setInterval(()=>{if(navMusicEl&&navMusicEl.querySelector("#nav-music meting-js").aplayer){clearInterval(e);navMusicEl.querySelector("#nav-music meting-js").aplayer.on("pause",function(){navMusicEl.classList.remove("playing"),document.getElementById("menu-music-toggle").innerHTML='<i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音樂</span>',document.getElementById("nav-music-hoverTips").innerHTML="音樂已暫停",document.querySelector("#consoleMusic").classList.remove("on"),anzhiyu_musicPlaying=!1,navMusicEl.classList.remove("stretch")}),navMusicEl.querySelector("#nav-music meting-js").aplayer.on("play",function(){navMusicEl.classList.add("playing"),document.getElementById("menu-music-toggle").innerHTML='<i class="anzhiyufont anzhiyu-icon-pause"></i><span>暫停音樂</span>',document.querySelector("#consoleMusic").classList.add("on"),anzhiyu_musicPlaying=!0})}},16)}function s(e){var t=27===e.keyCode,n=e.shiftKey,o=anzhiyu_keyboard,i=anzhiyu_intype,t=(t&&(anzhiyu.hideLoading(),anzhiyu.hideConsole(),rm)&&rm.hideRightMenu(),GLOBAL_CONFIG.shortcutKey.delay||100);let a=GLOBAL_CONFIG.shortcutKey.shiftDelay||200;o&&n&&!i&&(anzhiyu_keyUpShiftDelayEvent_timeoutId=setTimeout(()=>{switch(e.keyCode){case 16:anzhiyu_keyUpEvent_timeoutId=setTimeout(()=>{document.querySelector("#keyboard-tips").classList.add("show")},a);break;case 65:anzhiyu.switchConsole();break;case 77:anzhiyu.musicToggle();break;case 75:anzhiyu.keyboardToggle();break;case 73:anzhiyu.rightMenuToggle();break;case 82:toRandomPost();break;case 72:pjax.loadUrl("/");break;case 68:r.darkmode();break;case 70:pjax.loadUrl("/fcircle/");break;case 76:pjax.loadUrl("/link/");break;case 80:pjax.loadUrl("/about/")}e.preventDefault()},t))}function p(e){anzhiyu_keyUpEvent_timeoutId&&clearTimeout(anzhiyu_keyUpEvent_timeoutId),anzhiyu_keyUpShiftDelayEvent_timeoutId&&clearTimeout(anzhiyu_keyUpShiftDelayEvent_timeoutId),16===e.keyCode&&document.querySelector("#keyboard-tips").classList.remove("show")}if(GLOBAL_CONFIG.shortcutKey&&document.getElementById("consoleKeyboard")&&(localStorage.setItem("keyboardToggle","true"),document.getElementById("consoleKeyboard").classList.add("on"),anzhiyu_keyboard=!0,anzhiyu_keyboard=!!localStorage.getItem("keyboardToggle")&&localStorage.getItem("keyboardToggle"),window.onfocus=function(){document.getElementById("keyboard-tips").classList.remove("show")},(z=window).removeEventListener("keydown",s),z.removeEventListener("keyup",p),z.addEventListener("keydown",s),z.addEventListener("keyup",p)),GLOBAL_CONFIG.autoDarkmode&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{void 0===saveToLocal.get("theme")&&(e.matches?o("dark"):o("light"))}),GLOBAL_CONFIG.greetingBox){var L=GLOBAL_CONFIG.greetingBox.list,z=GLOBAL_CONFIG.greetingBox.default;let e=document.createElement("div"),n=(e.id="greeting",setTimeout(()=>{e.classList.add("shown")},1e3),document.getElementById("greetingBox"));if(n){n.appendChild(e);var b=(new Date).getHours();let t=z;for(let e=0;e<L.length;e++)if(b>=L[e].startTime&&b<=L[e].endTime){t=L[e].greeting;break}e.innerHTML=t,setTimeout(()=>{e.classList.remove("shown"),setTimeout(()=>{n.remove()},500)},3e3)}}GLOBAL_CONFIG.LA51&&i()});